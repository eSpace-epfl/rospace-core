<launch>

<!-- Launch Epoch Clock without params (=realtime, start from now) -->
    <node pkg="epoch_clock" name="epoch_clock_sim" type="epoch_clock.py" output="screen">
        <param name="realtime_factor" value="250" />
        <param name="init_epoch" value="20170915T12:20:00" />
    </node>

    <group ns="cso">
        <!-- Load Configuration File for sensors etc -->
        <rosparam command="load" file="$(find cso_gnc_sim)/cfg/cso.yaml" />

        <!-- Launch SGP4 node with TLE (cheating here and using a changed swisscube TLE) -->
        <node pkg="sgp4_node" name="sgp4_node_cso" type="sgp4_node.py" output="screen">
            <param name="tle_line1" value="1 35932U 09051B   17242.83495672  .00000195  00000-0  55221-4 0  9991" />
            <param name="tle_line2" value="2 35932  98.2062  22.7182 0008099  30.5945 324.2750 14.561341441421185" />
            <param name="attitude_mode" value="lof" />
        </node>


        <!-- Launch Radar Sensor -->
        <node pkg="space_sim_radar" name="node_radar1" type="sim_radar_node.py" output="screen">
            <remap from="~sensor" to="/cso/sensors/Radar" />
            <remap from="chaser_oe" to="oe" />
            <remap from="target_oe" to="/target/oe" />
        </node>

         <!-- Launch AON Sensor -->
        <node pkg="space_sim_aon" name="node_aon" type="sim_aon_node.py" output="screen">
            <param name="publish_rate" value="0.33" />
            <remap from="~sensor" to="/cso/sensors/AON" />
            <remap from="~thrusters" to="/cso/thrusters" />
            <remap from="chaser_oe" to="oe" />
            <remap from="target_oe" to="/target/oe" />
        </node>

          <!-- Launch Filter -->
        <node pkg="cso_gnc_target_estimator" name="target_estimator" type="cso_gnc_target_estimator_node.py" output="screen">
            <remap from="chaser_oe" to="oe" />
            <remap from="target_oe" to="/target/oe" />
        </node>
    </group>

  <group ns="target">

    <!-- Launch SGP4 node with TLE (cheating here and using swisscube TLE) -->
    <node pkg="sgp4_node" name="sgp4_node_target" type="sgp4_node.py" output="screen">
        <param name="tle_line1" value="1 35932U 09051B   17242.83495672  .00000195  00000-0  55221-4 0  9991" />
        <param name="tle_line2" value="2 35932  98.5062  22.7182 0008099  30.5945 329.5723 14.56041441421185" />
        <param name="attitude_mode" value="spin" />
        <param name="spin_rate"  value="1" /> <!-- 1 deg/s-->
        <param name="spin_axis"  value="1 1 0" />
    </node>

    <!-- Launch LVLH node -->
    <node name="lvlh_pub" pkg="lvlh_node" type="lvlh_node.py" output="screen" >
        <remap from="target_oe" to="/target/oe" />
        <remap from="chaser_oe" to="/cso/oe" />
    </node>

    <!-- Launch REL node -->
    <node name="rel_pub" pkg="rel_node" type="rel_node.py" output="screen" >
        <remap from="target_oe" to="/target/oe" />
        <remap from="chaser_oe" to="/cso/oe" />
    </node>

    </group>

</launch>
